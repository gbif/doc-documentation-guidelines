= GBIF Documentation Guidelines
GBIF Secretariat <communication@gbif.org>
:toc: left
:revnumber: 0.1-dev
:revdate: {localdate}
:title-logo-image: 1265538197-Cyperus-papyrus.jpg
:icons: font

ifdef::backend-html5[]
.https://www.gbif.org/occurrence/1265538197[_Cyperus papyrus_ L.], observed in Mexico by Alfonso Gutiérrez Aldana.  Photo (via iNaturalist) licensed under http://creativecommons.org/licenses/by-nc/4.0/[CC BY-NC 4.0].
image::1265538197-Cyperus-papyrus.jpg[Photograph of _Cyperus papyrus_ L.]
endif::backend-html5[]

ifdef::backend-html5[]
_languageLinks:pdf[This document is also available in,PDF format]._
endif::backend-html5[]

[preface]
== Background

ifdef::backend-pdf[]
Cover image: https://www.gbif.org/occurrence/1265538197[_Cyperus papyrus_ L.], observed in Mexico by Alfonso Gutiérrez Aldana.  Photo (via iNaturalist) licensed under http://creativecommons.org/licenses/by-nc/4.0/[CC BY-NC 4.0].
endif::backend-pdf[]

GBIF—the Global Biodiversity Information Facility—has long produced technical documentation on a range of topics relating to biodiversity informatics and open biodiversity data with the aim of supporting a global community of practice. 

The GBIF Secretariat is now seeking to clarify its coordination role in developing such documentation while engaging its community to collaborate with subject-matter experts commissioned to create and update under the guidance of an editorial panel. This goal of this approach is to provide uniform, reliable, reusable, versioned, and easily updatable materials that instill community trust in the available documentation and foster its use. 

The key features of this system will include

* Standardized documentation
* Routine updates, versioning and translations
* Community input 
* Peer review
* Searchable format

== The Editorial Panel

The Editorial Panel (EP) consists of a volunteer group of experts that, in coordination with GBIF Secretariat staff, will provide oversight, guidance and peer-review of the GBIF documentation. The EP will provide recommendations to the GBIF Secretariat on commissioning high-priority guidance from subject-matter experts, with the following responsibilities:

.Prioritize needs both for updating/revising existing documentation and for generating new documentation.
.Establish review process (how reviews will happen, how many members are required for review, timeline, etc.).
.Make recommendations regarding the documentation system (via GitHub repositories) for future sustainability.
.Review drafts and provide comments back to authors.

== Operations

Each year, the EP will review available documentation and identify priority candidates for updates. and will review and approve updated documentation for publication. The EP should consult widely with other experts, institutions, initiatives andprojects within the biodiversity informatics community at-large when considering updates to and for new documentation.

=== Annual process

. Annually, the EP shall prioritize documentation needs and make recommendations for calls for documentation when appropriate.
. Calls will issued by GBIFS to the community when appropriate.
. EP will review and make recommendations on documentation proposals.
. GBIFS will draw and issue contract with authors/teams of experts.
. Authors will compile first draft drawing on community input when appropriate and submit to EP.
. EP will review drafts and provide comments back to authors.
. Authors will revise drafts based on EP’s review.
. Versions will be released publicly and openly.
. GBIFS will complete and issue derived products (translations, training modules, etc.).

== Guidelines for document authors

Unlike a word processor like _Microsoft Word_, GBIF's documentation is stored in plain text files.  This means

* Authors need not worry about maintaining a consistent style,
* Changes to the document can be tracked and managed using general tools,
* The same source files can produce multiple outputs automatically, such as HTML and PDF,
* Document translations can be tracked.

Of course, that does mean learning about some different tools — but the ones we have chosen are widely used in publishing, software development and translation communities.

=== Writing in AsciiDoc
AsciiDoc is a text document format for writing (among other things) books, ebooks, and documentation. It is similar to wiki markup—if you can write a Wikipedia article, then you’ll have no problem with AsciiDoc.

This section illustrates some of the most common elements GBIF authors will use in writing technical documentation. The https://asciidoctor.org/docs/user-manual/[AsciiDoctor User Guide] and the [AsciiDoctor cheat sheet] provide more comprehensive references, but the following sections provide an overview of the markup you’ll use most frequently.

==== Text
Regular paragraph text does not need any special markup in AsciiDoc. Just add a blank line both above and below each paragraph, and the first word in the paragraph should not have a space before it. Here are some example paragraphs in AsciiDoc:

----
This is an example paragraph written in AsciiDoc. See, it's just plain text; no special markup necessary! Do make sure there aren't spaces or manual indentations at the beginning of your paragraph text.

This is a second example paragraph in AsciiDoc. Note that there's a line break and a blank line between paragraphs.
----

===== Chapters
The top of each chapter file should begin with a chapter title preceded by two equals signs. It's good practice to always include a unique ID string above the chapter title, surrounded in double brackets, for example:

----
[[unique_chapter_id]]
==== Chapter Title

Chapter text begins here.
----

==== Headings
NOTE: In AsciiDoc, the document (book) is considered a level 0 header, so a chapter generally starts AsciiDoc level 1 (a notable exception being when you're dividing the book into parts). In this scenario, sections within chapters start at AsciiDoc level 3.

===== Top-level heading
Within a chapter, the first and highest heading level uses three equals signs:

----
=== Top-Level Heading
----

====== Second-level heading
This heading level should only follow a top-level heading:

----
==== Second-Level Heading
----

====== Third-level heading
This heading level should follow a second-level heading only:

----
===== Third-level heading
----

==== Prefaces
A preface file should begin with the word preface in single brackets, followed on the next line by two equals signs and the preface title:

----
[preface]
== Preface Title

Preface text begins here.
----

==== Forewords
A foreword file should begin with the word foreword in single brackets, followed on the next line by two equals signs and the foreword title:

----
[foreword]
== Foreword

Foreword text begins here.
----

==== Afterwords
The markup for an Afterword is similar to the preface markup, but it has an additional role attribute with a value of "afterword". Here's the markup:

----
[preface]
[role="afterword"]
== Afterword

Afterword text begins here.
----

==== Dedications
A dedication file should begin with the word dedication in single brackets, followed by a blank line and then the dedication title and text. The title must be present, but it will not render in the output:

----
[dedication]
== Dedication

Once again to Zelda.
----
Dedication pages render on their own page at the beginning of the book, before the table of contents.

==== Glossaries

A glossary file should begin with the word glossary in double brackets, followed by the glossary title and a blank line. Following the blank line should be another instance of the word glossary, this time in single brackets.

Each glossary entry should consist of one glossary term, followed by two colons and a space, then the glossary definition. If you’d like to add an additional paragraph to a glossary definition, add a plus sign ("+") on the following line by itself, and begin the additional paragraph on the line after it.

Here’s an example of the markup:

----
[[glossary]]
== Glossary

[glossary]
Participant:: a country, economy or organization that joins GBIF by signing a https://www.gbif.org/document/80661[Memorandum of Understanding] and establishing a co-ordinated effort to support open access and use of biodiversity data, to advance scientific research, and to promote technological and sustainable development. 

Biodiversity information facility:: Variously described as a ‘BIF’, a system or a network, a broader structure of people and institutions, coordinated by the node, that collectively forms an infrastructure for delivering biodiversity information to relevant stakeholders.

Participant node:: a coordinating team designated by the Participant to coordinate a network of people and institutions that produce, manage and use biodiversity data, collectively building an infrastructure for delivering biodiversity information.
----

==== Appendixes
To designate a file as an appendix, simply add the word appendix in single brackets at the top of the file. Immediately below it should be the title of the Appendix. For example:

----
[appendix]
== Resources

The following list of resources ...
----

==== Inline Markup
Here are some standard typographical conventions with explanations of how they're commonly used:

_Italic_
One underscore character on either side of text marks it as italics in AsciiDoc.

Should you need to mark only a few letters of a word in italics, or a word that abuts a non-whitespace character, double up the underscore characters on either side of the text: __Part__ial word i__tal__ic

*Bold*
Bolded text is used to emphasize a word or phrase. The AsciiDoc markup is one asterisk on either side of the text to be bolded.

Should you need to mark only a few letters of a word in bold, or a word that abuts a non-whitespace character, double up the asterisk characters on either side of the text, like this: **Part**ial word b**ol**d

+Constant Width+
Constant width, or monospaced, text is used for code, as well as within paragraphs to refer to program elements such as variable or function names, databases, data types, environment variables, statements, and keywords. The AsciiDoc markup is one plus sign on either side of the text to monospaced.

Should you need to mark only a few letters of a word in constant width, or a word that abuts a non-whitespace character, double up the plus signs on either side of the text, like this: ++Part++ial word con++st++ant wid++th++

*+Constant Width Bold+*
Monospaced and bolded text is used to show commands or other text that should be typed literally by the user. The AsciiDoc markup is one asterisk and one plus sign on either side of the text. Note that the asterisk (*) pair should be on the outside and the plus-symbol (+) pair on the inside.

Should you need to mark only a few letters of a word in constant width bold, or a word that abuts a non-whitespace character, double up the markup on either side of the text, like this: **++Part++**ial word constant w**++id++**th bold

_++Constant Width Italic++_
Monospaced and italicized text indicates where text should be replaced with user-supplied values or by values determined by context. The AsciiDoc markup is one underscore and two plus signs on either side of the text. Note that the underscore (_) must be on the outside and the plus-symbol (+) pair on the inside.

Should you need to mark only a few letters of a word in  constant width italic, or a word that abuts a non-whitespace character, double up the underscore markup on either side of the text, like this: __++Part++__ial word con__++st++__ant width ital__++ic++__

~subscript~
For subscript text, use a tilde character (~) on either side of the subscript text.

^superscript^
For superscript text, use a caret (^) character on either side of the superscript text.

_Hyperlinks_
For hyperlinks to external sources, just add the full URL string followed by brackets containing the text you'd like to appear with the URL. The bracketed text will become a clickable link in web versions. In print versions, it will appear in the text, followed by the actual URL in parenthesis.

The markup looks like this:

----
Visit https://www.gbif.org[GBIF.org].
----


=== "Source code"

The plain text files and other assets (images, data tables) that form each document comprises the _source code_.

These source files are stored in a _Git repository_, which (for GBIF) is managed by a commercial service, _GitHub_.

The source code for this document is stored at https://github.com/gbif/doc-documentation-guidelines/, the source code for this part of the document can be seen https://raw.githubusercontent.com/gbif/doc-documentation-guidelines/master/index.adoc[here].

Contributors can edit the source code either in a web browser using the GitHub interface or on a computer (including when offline) using Git. They may also submit https://github.com/gbif/doc-documentation-guidelines/issues[issues] that comment or flag problems for others to address, including outdated information, broken links, misspellings and the like.

NOTE: Many tutorials for using both Git and Github are available on the web.

=== AsciiDoctor

GBIF documentation is maintained and published using a fast text processor and publishing toolchain called _AsciiDoctor_. Content for this system uses AsciiDoc, a lightweight _markup language_ whose format and structure (such as headings and bold text) are applied using particular symbols and conventions visible in the text. AsciiDoctor then converts this AsciiDoc syntax into the required formatting depending on the output format.

For example, the source code for the heading and first line of this section looks like this:

```
=== AsciiDoctor

GBIF documentation is maintained and published using a fast text processor and publishing toolchain called _AsciiDoctor_.
```

The `pass:[===]` prefix indicates a third-level heading, and the underscore symbols surrounding `+_AsciiDoc_+` specify emphasized text. Decisions regarding elements like the font or text size are not included in the main document.

The document (or parts of it) is stored in files with the extension `.en.adoc`, where `.en.` indicates the language using the ISO two-letter language codes. Other source files such as images have their usual extensions.

The main document that compiles any given document is called `index.en.adoc`.

NOTE: For information on the syntax of AsciiDoctor, see the https://asciidoctor.org/docs/user-manual/[Asciidoctor User Manual].

=== Generating the document

The source code in the repository is converted into the finished HTML and PDF documents using the _Asciidoctor_ tool.  Every time a change is made to the repository, the GBIF build server is notified.  It retrieves the source code, generates the document, and copies the formatted documents to a webserver.

A log file of recent builds is kept by the build server.  If there is a syntax error preventing the document from being generated, you may need to inspect the log file to see what the problem is.

=== Local document build

WARNING: This section isn't yet final, as the tools are still being developed.

If you are familiar with software development tools, and using GBIF's office network or VPN, you can build a document on your own computer – this is useful for previewing changes.  You can build the HTML document with this command, run from the top level directory:

`+docker run --rm -it -v $PWD:/documents/ mb.gbif.org:5000/gbif-asciidoctor-toolkit+`

To create the PDF document, use `asciidoctor-pdf` rather than `asciidoctor`.  The result is called either `index.en.html` or `index.en.pdf`.

=== Further guidelines

_We should perhaps include in this document:_

* Handling issues in GitHub,
* Handling pull requests,
* Who to ask for help.

== Guidelines for document translators

The translation uses `.po` "_Portable Object_" files, which are commonly used for translating software and websites.  To translate a document into a new language, or update an existing translation, you will need to:

. For a new language, copy the `index.pot` (_Portable Object Template_) file to the new file `xx.po`, where `xx` is the https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes[language code], for example this would be `da.po` for a Danish translation.
. To update a translation, open the `xx.po` file in a po-file editor and choose the option to "Update from POT file" or similar.
. Use a po-file editor to make the translations.  Examples are https://poedit.net/[Poedit] (software) or https://localise.biz/free/poeditor[poeditor] (website).
. Use Git/GitHub to replace the old translation file with your updated translation file.

== Guidelines for software developers

NOTE: This section is technical information for GBIF software developers maintaining the system that powers these documents.

The documents combine several small Linux tools:

* Git, for source control,
* https://asciidoctor.org/[Asciidoctor], chosen with essentially the same reasoning as https://github.com/KiCad/kicad-doc/blob/5.1.0/doc_alternatives/README.adoc[the KiCad documentation authors] (and following their approach to translation),
* https://po4a.org/[po4a], for translations,
* https://builds.gbif.org/[GBIF's Jenkins server], for document compilation,
* Docker, to ensure consistent builds,
* Apache, to serve the finished documents.

The result is mostly contained in a https://github.com/gbif/gbif-asciidoctor-toolkit[Docker container], with some integration in the Jenkins build job.

=== New documents

New documents should be made by:

. Cloning the https://github.com/gbif/doc-template[doc-template] repository, with a name beginning with `doc-`,
. Adding a new job to Jenkins.

=== Outstanding issues:

. Apply a custom style to the document,
. Demonstrate embedding an image, and alternative (translated) images,
. Determine where the exported documents will be stored,
. Decide a release process, possibly involving assigning DOIs.
